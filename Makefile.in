CC = @CC@
datarootdir = @datarootdir@
prefix = @prefix@
CFLAGS = @CFLAGS@
OBJS = ai.o map.o character.o dice.o diplomacy.o editor.o feud.o file.o mapgen.o new.o piece.o server.o time.o window.o world.o
CLI_OBJS = map.o character.o dice.o diplomacy.o file.o piece.o time.o world.o
EXECS = feud feud-editor feud-ai feud-server

.PHONY: all clean distclean install uninstall

all: $(EXECS)

$(OBJS): %.o: %.c
	$(CC) -c $(CFLAGS) $< -o $@

feud: $(CLI_OBJS) feud.o new.o mapgen.o window.o
	$(CC) $(CFLAGS) -o feud $(CLI_OBJS) feud.o new.o mapgen.o window.o -lncurses -lm

feud-editor: $(CLI_OBJS) editor.o new.o mapgen.o window.o
	$(CC) $(CFLAGS) -o feud-editor $(CLI_OBJS) editor.o new.o mapgen.o window.o -lncurses -lm

feud-ai: $(CLI_OBJS) ai.o
	$(CC) $(CFLAGS) -o feud-ai $(CLI_OBJS) ai.o -lm

feud-server: $(CLI_OBJS) server.o
	$(CC) $(CFLAGS) -o feud-server $(CLI_OBJS) server.o -lm

clean:
	for i in $(OBJS) $(EXECS); do \
	if [ -e $$i ]; then rm -v $$i; fi; \
	done

distclean: clean
	rm config.log config.status Makefile

install:
	if [ ! -d $(DESTDIR)$(prefix)/bin ]; then mkdir -p $(DESTDIR)$(prefix)/bin; fi
	for EXEC in $(EXECS); do \
	if [ -e $(DESTDIR)$(prefix)/bin/$$EXEC ]; then rm $(DESTDIR)$(prefix)/bin/$$EXEC; fi; \
	install -m 755 $$EXEC $(DESTDIR)$(prefix)/bin/$$EXEC; \
	done

uninstall:
	for EXEC in $(EXECS); do \
	if [ -e $(DESTDIR)$(prefix)/bin/$$EXEC ]; then rm $(DESTDIR)$(prefix)/bin/$$EXEC; fi; \
	done
